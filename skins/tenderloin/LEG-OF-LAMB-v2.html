<!doctype html>
<!-- © 2025 DinnerMath — Calculator code and design are proprietary. Licensed for end-user viewing only via comesail.github.io. -->
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>DinnerMath — Leg of Lamb Quantity Calculator (Tenderloin ultratight)</title>
  <meta name="description" content="Estimate how many pounds of raw leg of lamb to buy and approximate cooked yield (planning estimate).">
  <style>
    :root{ --ink:#111827; --muted:#6b7280; --line:#e5e7eb; --bg:#ffffff; }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0}
    body{background:var(--bg);color:var(--ink);font-family:Inter, ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, Helvetica, Arial}
    a{color:var(--ink);text-decoration:underline}
    .wrap{max-width:740px;margin:0 auto;padding:clamp(8px,1.6vw,14px)}
    .card{background:#fff;border:1px solid var(--line);border-radius:0;padding:10px;margin:8px 0;box-shadow:0 1px 0 rgba(17,24,39,.06),0 1px 2px rgba(17,24,39,.05)}
    h1{font-size:20px;margin:0 0 6px;text-align:center;font-weight:800}
    h3{font-size:15px;margin:0 0 6px;text-align:center;font-weight:800}
    .lede{color:var(--muted);margin:0 0 8px;text-align:center;font-size:12.5px}
    label{font-size:10.5px;color:#374151;display:block;margin:0 0 2px;font-weight:600}
    input[type=number], select{width:100%;border:1px solid #d1d5db;border-radius:7px;padding:6px 8px;font-size:12.5px;line-height:1.2;background:#fff;color:var(--ink);height:34px}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:6px}
    .guest-grid{display:grid;grid-template-columns:110px 110px 110px 1fr;gap:6px;align-items:end}
    .inline{display:flex;align-items:center;gap:6px;flex-wrap:wrap}
    .muted{color:var(--muted);font-size:11px}
    .fine{font-size:12.5px;color:#374151;line-height:1.35}
    .btn{display:inline-block;border:1.5px solid #111827;border-radius:999px;padding:6px 10px;font-size:12.5px;font-weight:700;color:#111827;background:#fff;cursor:pointer}
    .pill{font-size:10px;border:1px solid #d1d5db;border-radius:999px;padding:2px 6px;color:#475569;background:#fff;text-decoration:none}
    .presets .btn{border-width:2px}
    .result{border:2px solid #111827;padding:10px;background:#fff}
    .big{font-size:24px;font-weight:900;line-height:1.2;margin:6px 0}
    .grid2{display:grid;grid-template-columns:1fr 1fr;gap:8px}
    .finder{padding:8px;border:2px solid #111827}
    .divider{height:1px;background:var(--line);margin:8px 0}
    .visually-hidden{position:absolute!important;clip:rect(1px,1px,1px,1px);clip-path:inset(50%);height:1px;width:1px;overflow:hidden;white-space:nowrap;border:0;padding:0;margin:-1px}
    @media (max-width:820px){ .row,.guest-grid,.grid2{grid-template-columns:1fr} }
  </style>
</head>
<body>
  <div class="wrap">

    <!-- Header -->
    <div class="card" role="region" aria-label="Header">
      <h1>Leg of Lamb — Quantity Calculator</h1>
      <p class="lede">Enter guests and settings (or tap a quick preset). We will estimate how many pounds of raw leg of lamb to buy (planning estimate).</p>
    </div>

    <!-- Inputs -->
    <div class="card" role="region" aria-label="Inputs">
      <h3>Inputs</h3>
      <div class="guest-grid" aria-label="Guests">
        <div><label for="A">Adults</label><input id="A" type="number" min="0" step="1" value="10" autofocus></div>
        <div><label for="T">Teens</label><input id="T" type="number" min="0" step="1" value="0"></div>
        <div><label for="C">Children</label><input id="C" type="number" min="0" step="1" value="0"></div>
        <div>
          <label for="course">Course mode</label>
          <select id="course">
            <option value="main" selected>Main dish</option>
            <option value="mixed">Mixed buffet</option>
            <option value="app">Appetizer/snack</option>
          </select>
        </div>
      </div>

      <div class="row" aria-label="Context" style="margin-top:6px">
        <div>
          <label for="cut">Cut style</label>
          <select id="cut">
            <option value="bonein" selected>Bone-in (about 35% shrink)</option>
            <option value="semi">Semi-boneless (about 30% shrink)</option>
            <option value="boneless">Boneless (about 25% shrink)</option>
          </select>
          <div class="muted">We convert cooked ounces to raw pounds using the cut yield.</div>
        </div>
        <div>
          <label for="appetite">Appetite</label>
          <select id="appetite">
            <option value="0.90">Light</option>
            <option value="1.00" selected>Typical</option>
            <option value="1.20">Hearty</option>
          </select>
        </div>
        <div>
          <label for="length">Event length</label>
          <select id="length">
            <option value="0.95">Short — about 1 to 2 hours</option>
            <option value="1.00" selected>Standard — about 2 to 3 hours</option>
            <option value="1.08">Long — about 3 to 4 hours</option>
            <option value="1.15">Extended — about 4 to 5 hours</option>
          </select>
        </div>
        <div>
          <label for="leftovers">Add leftovers</label>
          <select id="leftovers">
            <option value="1.00" selected>No</option>
            <option value="1.10">+10%</option>
            <option value="1.20">+20%</option>
          </select>
        </div>
      </div>

      <!-- Presets + Reset -->
      <div class="inline presets" style="margin-top:6px">
        <span class="muted">Quick presets:</span>
        <button class="btn preset" data-people="10" type="button">10</button>
        <button class="btn preset" data-people="25" type="button">25</button>
        <button class="btn preset" data-people="50" type="button">50</button>
        <button class="btn preset" data-people="100" type="button">100</button>
        <span class="muted">Presets set all as Adults — tweak Teens or Children if needed.</span>
        <div style="flex:1"></div>
        <button id="dmReset" type="button" class="btn">Reset</button>
      </div>
    </div>

    <!-- Micro-summary -->
    <div class="muted" id="micro">-</div>

    <!-- Results -->
    <div class="card" role="region" aria-label="Results" aria-live="polite" aria-atomic="true">
      <h3>Results (estimate)</h3>
      <div class="result">
        <div class="muted" aria-hidden="true">Estimated raw leg of lamb to buy</div>
        <div id="outBig" class="big" aria-label="Estimated pounds to buy: 0">-</div>
        <div class="fine" id="outFrom">-</div>
        <div class="fine" id="outFromTL">-</div>
        <div class="fine muted" id="outBatchNote"></div>
        <div class="divider"></div>
        <div class="inline">
          <span class="pill" id="pillGuests">-</span>
          <span class="pill" id="pillCut">-</span>
          <span class="pill" id="pillPrice">pricing optional</span>
        </div>
      </div>

      <div class="grid2" style="margin-top:10px">
        <div class="card" style="margin:0">
          <h3>Cost estimate</h3>
          <div class="inline">
            <div><label>Subtotal</label><div id="outSubtotal" class="fine">$-</div></div>
            <div><label>Tax and fees</label><div id="outAdds" class="fine">$-</div></div>
            <div><label>Estimated total</label><div id="outTotal" class="fine">$-</div></div>
            <div><label>Per person</label><div id="outPPP" class="fine">$-</div></div>
          </div>
        </div>
        <div class="card finder" role="region" aria-label="Find near me" style="margin:0">
          <div class="inline">
            <a class="btn" href="#" onclick="try{window.open('https://www.google.com/maps/search/leg+of+lamb+near+me','_blank');}catch(e){location.href='https://www.google.com/maps/search/leg+of+lamb+near+me';}return false;">Find leg of lamb near me</a>
            <a class="pill" href="#" onclick="try{window.open('https://www.google.com/maps/search/butcher+shop','_blank');}catch(e){location.href='https://www.google.com/maps/search/butcher+shop';}return false;">Butcher shops</a>
            <a class="pill" href="#" onclick="try{window.open('https://www.google.com/maps/search/grocery+store','_blank');}catch(e){location.href='https://www.google.com/maps/search/grocery+store';}return false;">Grocery stores</a>
          </div>
        </div>
      </div>
    </div>

    <!-- Pricing (optional) -->
    <div class="card" role="region" aria-label="Pricing">
      <h3>Pricing (optional)</h3>
      <div class="row">
        <div>
          <label for="priceLb">Unit price — per pound raw (US dollars)</label>
          <input id="priceLb" type="number" min="0" step="0.01" placeholder="e.g., 9.99">
        </div>
        <div>
          <label for="taxPct">Sales tax (percent)</label>
          <input id="taxPct" type="number" min="0" step="0.1" placeholder="e.g., 7.5">
        </div>
        <div>
          <label for="fees">Extra fees (US dollars)</label>
          <input id="fees" type="number" min="0" step="0.01" placeholder="e.g., 8.00">
        </div>
      </div>
      <div class="muted">Cost = rounded raw pounds × unit price + tax + fees.</div>
    </div>

  </div>

  <script>
  // --- math & logic (preserved from original) ---
  (function(){
    const $ = id => document.getElementById(id);
    const N = (v,d=0)=>{const n=parseFloat(v);return isFinite(n)?n:d;};
    const money = n => (isFinite(n)&&n>=0) ? "$"+n.toFixed(2) : "$-";
    const fmt = (n,d=0)=> isFinite(n) ? n.toLocaleString(undefined,{minimumFractionDigits:d,maximumFractionDigits:d}) : "-";
    const roundQtr = lbs => Math.round(lbs*4)/4;

    function cookedPerAdultOz(course){
      if(course==="main")  return {adult:8.0, teen:6.5, child:4.8};
      if(course==="mixed") return {adult:6.0, teen:4.8, child:3.6};
      return                {adult:3.5, teen:2.8, child:2.1}; // appetizer
    }
    function yieldForCut(cut){
      if(cut==="boneless") return 0.75;
      if(cut==="semi") return 0.70;
      return 0.65; // bone-in default
    }

    function microSummary(s){
      const courseTxt = ($("course").selectedOptions[0]||{}).text.toLowerCase();
      const lengthTxt = ($("length").selectedOptions[0]||{}).text.toLowerCase();
      const leftoversTxt = ($("leftovers").selectedOptions[0]||{}).text.toLowerCase();
      const appetiteTxt = ($("appetite").selectedOptions[0]||{}).text.toLowerCase();
      const cutTxt = ($("cut").selectedOptions[0]||{}).text.toLowerCase();
      return (s.guests||0)+" guests • "+courseTxt+" • "+appetiteTxt+" appetite • "+lengthTxt+" • leftovers "+leftoversTxt+" • "+cutTxt;
    }

    function compute(){
      const A=N($("A").value,0), T=N($("T").value,0), C=N($("C").value,0);
      const guests = A+T+C;

      const course = $("course").value;
      const cut = $("cut").value;
      const appetite = N($("appetite").value,1.0);
      const length   = N($("length").value,1.0);
      const leftovers= N($("leftovers").value,1.0);

      const base = cookedPerAdultOz(course);
      let cookedOz = (A*base.adult + T*base.teen + C*base.child);
      cookedOz *= appetite * length * leftovers;

      const cookedLb = cookedOz/16;
      const yieldFactor = yieldForCut(cut); // cooked = raw * yield
      const rawLb = (yieldFactor>0) ? (cookedLb / yieldFactor) : 0;

      const rawRounded = roundQtr(Math.max(0, rawLb));

      return {A,T,C,guests, course, cut, cookedLb, rawRounded, raw:rawLb};
    }

    function render(){
      const s = compute();

      // Big number: raw pounds
      if(s.guests>0){
        $("outBig").textContent = "About " + fmt(s.rawRounded,(s.rawRounded%1)?2:0) + " lb raw";
        $("outBig").setAttribute("aria-label","Estimated pounds to buy: " + fmt(s.rawRounded,(s.rawRounded%1)?2:0));
        $("outFrom").textContent =
          "Estimated from " + s.guests + " guests — " +
          ($("course").selectedOptions[0]||{}).text.toLowerCase() + ", " +
          ($("appetite").selectedOptions[0]||{}).text.toLowerCase() + " appetite, " +
          ($("length").selectedOptions[0]||{}).text.toLowerCase() + ", leftovers " +
          ($("leftovers").selectedOptions[0]||{}).text.toLowerCase() + ", " +
          ($("cut").selectedOptions[0]||{}).text.toLowerCase() + ".";
        $("outFromTL").textContent = "About " + fmt(s.cookedLb,(s.cookedLb%1)?2:0) + " lb cooked.";
        $("pillGuests").textContent = s.guests + " guests total";
        $("pillCut").textContent = ($("cut").selectedOptions[0]||{}).text.toLowerCase();
      } else {
        ["outBig","outFrom","outFromTL","pillGuests","pillCut"].forEach(id=>{ const el=$(id); if(el) el.textContent="-"; });
        $("outBig").setAttribute("aria-label","Estimated pounds to buy: 0");
      }

      // Pricing
      const p = N($("priceLb").value,0);
      const tax = N($("taxPct").value,0)/100;
      const fees = N($("fees").value,0);
      const subtotal = (p>0 && s.rawRounded>0) ? s.rawRounded * p : 0;
      const adds = subtotal * tax + (fees>0?fees:0);
      const total = subtotal + adds;
      const ppp = (s.guests>0 && total>0) ? total/s.guests : NaN;

      $("outSubtotal").textContent = subtotal>0 ? money(subtotal) : "$-";
      $("outAdds").textContent     = subtotal>0 ? money(adds) : "$-";
      $("outTotal").textContent    = subtotal>0 ? money(total) : "$-";
      $("outPPP").textContent      = (subtotal>0 && s.guests>0) ? money(ppp) : "$-";

      $("micro").textContent = microSummary(s);
      $("outBatchNote").textContent = ""; // (no unit-sized warnings for bulk pounds)
    }

    // Listeners
    ["A","T","C","course","cut","appetite","length","leftovers","priceLb","taxPct","fees"].forEach(id=>{
      const el=$(id); if(el){ el.addEventListener("input",render); el.addEventListener("change",render); }
    });

    // Presets
    document.querySelectorAll("button.preset").forEach(btn=>{
      btn.addEventListener("click", function(){
        const n = parseInt(btn.getAttribute("data-people")||"0",10);
        const A=$("A"),T=$("T"),C=$("C");
        if(A){A.value=n;}
        if(T){T.value=0;}
        if(C){C.value=0;}
        render();
      });
    });

    // Reset
    (function attachReset(){
      const btn=document.getElementById("dmReset"); if(!btn) return;
      btn.addEventListener("click", ()=>{
        document.querySelectorAll("input, select").forEach(el=>{
          if(el.tagName==="SELECT"){
            const i=Array.from(el.options).findIndex(o=>o.defaultSelected);
            el.selectedIndex = i>=0 ? i : 0;
          } else { el.value = el.defaultValue; }
        });
        document.querySelectorAll("input, select").forEach(el=>{
          el.dispatchEvent(new Event("input",{bubbles:true}));
          el.dispatchEvent(new Event("change",{bubbles:true}));
        });
        render();
      });
    })();

    // Select-all on focus for A/T/C
    ["A","T","C"].forEach(id=>{
      const el=$(id); if(!el) return;
      function sel(){ try{ el.select(); }catch(e){} }
      el.addEventListener("focus", ()=> setTimeout(sel,0));
      el.addEventListener("click", sel);
      el.addEventListener("mouseup", e=> e.preventDefault());
      el.addEventListener("touchend", sel);
    });

    render();
  })();
  </script>

  <!-- Legal footer -->
  <div class="muted" style="text-align:center;margin:16px 0 0 0;">
    This tool provides general portion and cost estimates for planning only. Results depend on the information you enter and typical averages.
    DinnerMath is not responsible for decisions, purchases, or outcomes based on these estimates.<br>
    © 2025 DinnerMath. All rights reserved. Use for planning only.
  </div>
</body>
</html>
