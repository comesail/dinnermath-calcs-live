<!doctype html>
<!-- © 2025 DinnerMath — Calculator code and design are proprietary. Licensed for end-user viewing only via comesail.github.io. -->
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>DinnerMath — Pies by Slice Quantity Calculator (Tenderloin ultratight)</title>
<meta name="description" content="How much pie per person. We estimate about slices, about how many pies, and pie pounds for pricing (planning estimate).">
<style>
  :root{ --ink:#111827; --muted:#6b7280; --line:#e5e7eb; --bg:#ffffff; --card:#ffffff; }
  *{box-sizing:border-box}
  html,body{margin:0;padding:0}
  body{background:var(--bg);color:var(--ink);font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Helvetica, Arial}
  .wrap{max-width:740px;margin:0 auto;padding:clamp(8px,1.6vw,14px)}
  .dm-card{background:var(--card);border:1px solid var(--line);border-radius:0px;padding:10px;margin:8px 0;box-shadow:0 1px 0 rgba(17,24,39,.06), 0 1px 2px rgba(17,24,39,.05)}
  h1{font-size:20px;margin:0 0 6px;text-align:center;font-weight:800}
  h2{font-size:16px;margin:10px 0 6px;text-align:center;font-weight:800}
  h3{font-size:15px;margin:0 0 6px;text-align:center;font-weight:800}
  .lede{color:var(--muted);margin:0 0 8px;text-align:center;font-weight:400;font-size:12.5px}
  .row{display:grid;grid-template-columns:1fr 1fr;gap:6px}
  @media (max-width:820px){.row{grid-template-columns:1fr}}
  label{font-size:10.5px;color:#374151;display:block;margin:0 0 2px;font-weight:600;text-align:left}
  input[type="number"],select{width:100%;border:1px solid #d1d5db;border-radius:0px;padding:7px 9px;font-size:12.5px;line-height:1.2;background:#fff;color:var(--ink)}
  .muted{color:var(--muted);font-size:11px}
  .fine{font-size:12.5px;color:#374151;line-height:1.35}
  .inline{display:flex;align-items:center;gap:6px;flex-wrap:wrap}
  .divider{height:1px;background:var(--line);margin:8px 0}
  .btn{display:inline-block;border:1.5px solid var(--ink);border-radius:999px;padding:5px 10px;font-size:13px;font-weight:800;cursor:pointer;background:#fff;text-decoration:none;color:var(--ink)}
  .btn:hover{background:#f3f4f6}
  .btn:focus-visible{outline:3px solid #94a3b8;outline-offset:2px}
  .pill{font-size:10px;border:1px solid #d1d5db;border-radius:999px;padding:2px 6px;color:#475569;background:#fff;text-decoration:none}
  .preset{border:2px solid var(--ink);background:#f8fafc;border-radius:999px;padding:5px 10px;font-size:13px;font-weight:800;cursor:pointer}
  .preset:hover{background:#eef2f7}
  .result{border:2px solid var(--ink);border-radius:0px;padding:10px;margin-top:6px;background:#fff}
  .result .big{font-size:24px;font-weight:800;line-height:1.2;color:var(--ink);font-variant-numeric:tabular-nums}
  .finder{padding:8px;border-radius:0px;border:2px solid var(--ink);background:#fff}
  [aria-label="Guests"]{display:flex;flex-wrap:wrap;gap:6px;align-items:flex-end}
  [aria-label="Guests"]>div{flex:0 0 auto}
  #A,#T,#C{width:110px}
  [aria-label="Guests"]>div:nth-child(4){flex:1 1 240px;min-width:220px}
  .row-2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
  @media (max-width:820px){ .row-2{grid-template-columns:1fr} }
  a, a:visited{color:var(--ink)}
</style>
</head>
<body class="ultra">
  <div class="wrap" id="pies-by-slice">

    <!-- Header -->
    <div class="dm-card" role="region" aria-label="Header">
      <h1>Pies by Slice — Quantity Calculator</h1>
      <p class="lede">
        Enter guests and settings (or tap a quick preset). We will estimate about how many slices and whole pies (planning estimate).
      </p>
    </div>

    <!-- Inputs -->
    <div class="dm-card" role="region" aria-label="Inputs">
      <h2>Inputs</h2>

      <div class="row" aria-label="Guests">
        <div>
          <label for="A">Adults</label>
          <input id="A" type="number" inputmode="numeric" min="0" step="1" value="10" placeholder="0">
        </div>
        <div>
          <label for="T">Teens</label>
          <input id="T" type="number" inputmode="numeric" min="0" step="1" value="0" placeholder="0">
        </div>
        <div>
          <label for="C">Children</label>
          <input id="C" type="number" inputmode="numeric" min="0" step="1" value="0" placeholder="0">
        </div>
        <div>
          <label for="course">Course mode</label>
          <select id="course">
            <option value="dessert" selected>Dessert table</option>
            <option value="party">Party main dessert</option>
            <option value="wedding">Wedding slivers</option>
            <option value="coffee">Coffee break</option>
          </select>
        </div>
      </div>

      <div class="row" aria-label="Context">
        <div>
          <label for="length">Event length</label>
          <select id="length">
            <option value="0.95">Short - about 1 to 2 hours</option>
            <option value="1.00" selected>Standard - about 2 to 3 hours</option>
            <option value="1.08">Long - about 3 to 4 hours</option>
            <option value="1.15">Extended - about 4 to 5 hours</option>
          </select>
        </div>
        <div>
          <label for="leftovers">Leftovers</label>
          <select id="leftovers">
            <option value="1.00" selected>No</option>
            <option value="1.10">10%</option>
            <option value="1.20">20%</option>
          </select>
        </div>
        <div>
          <label for="appetite">Appetite</label>
          <select id="appetite">
            <option value="0.90">Light</option>
            <option value="1.00" selected>Typical</option>
            <option value="1.20">Hearty</option>
          </select>
        </div>
        <div>
          <label for="pie">Pie size class (approx slices per pie)</label>
          <select id="pie">
            <option value="6|8">Small - 8 in pie (about 6 slices)</option>
            <option value="8|9" selected>Average - 9 in pie (about 8 slices)</option>
            <option value="10|10">Large - 10 in pie (about 10 slices)</option>
            <option value="12|12">Jumbo - 12 in pie (about 12 slices)</option>
          </select>
          <div class="muted">We convert needed slices to about how many pies using your size class.</div>
        </div>
      </div>

      <div class="inline" style="margin-top:6px">
        <span class="muted">Quick presets:</span>
        <button class="preset" data-people="10" type="button">10</button>
        <button class="preset" data-people="25" type="button">25</button>
        <button class="preset" data-people="50" type="button">50</button>
        <button class="preset" data-people="100" type="button">100</button>
        <span class="muted">Presets set all as adults. Tweak Teens and Children if needed.</span>
        <div style="flex:1"></div>
        <button id="dmReset" type="button" class="btn">Reset</button>
      </div>
    </div>

    <!-- Micro-summary -->
    <div class="dm-card" role="region" aria-label="Micro-summary">
      <div id="outMicro" class="fine">-</div>
    </div>

    <!-- Results (estimate) -->
    <div class="dm-card" style="border:none; box-shadow:none; padding:0; margin:0 0 4px;" aria-hidden="true"><h2>Results (estimate)</h2></div>
    <div class="dm-card result" role="region" aria-label="Results (estimate)" aria-live="polite">
      <div class="big" id="outSlices" aria-label="Estimated slices to serve: 0">-</div>
      <div id="outFrom" class="fine">-</div>
      <div id="outAlso" class="fine muted"></div>
      <div id="outBatchNote" class="fine muted"></div>

      <div class="divider"></div>
      <div class="row-2" style="margin-top:10px">
        <div class="dm-card" style="margin:0">
          <h3>Cost estimate</h3>
          <div class="inline">
            <div><label>Subtotal</label><div id="outSubtotal" class="fine">$-</div></div>
            <div><label>Tax and fees</label><div id="outAdds" class="fine">$-</div></div>
            <div><label>Estimated total</label><div id="outTotal" class="fine">$-</div></div>
            <div><label>Per person</label><div id="outPPP" class="fine">$-</div></div>
          </div>
        </div>
        <div class="dm-card finder" role="region" aria-label="Find near me" style="margin:0">
          <div class="inline">
            <a class="btn" href="#" onclick="try{window.open('https://www.google.com/maps/search/pie+bakery+near+me');}catch(e){} return false;">Find pie near me</a>
            <a class="pill" href="#" onclick="try{window.open('https://www.google.com/maps/search/bakery');}catch(e){} return false;">Bakeries</a>
            <a class="pill" href="#" onclick="try{window.open('https://www.google.com/maps/search/catering');}catch(e){} return false;">Catering</a>
          </div>
        </div>
      </div>
    </div>

    <!-- Pricing (optional) -->
    <div class="dm-card" role="region" aria-label="Pricing">
      <h3>Pricing (optional)</h3>
      <div class="row">
        <div>
          <label for="priceMode">Pricing mode</label>
          <select id="priceMode">
            <option value="slice" selected>Per slice</option>
            <option value="pie">Per pie</option>
          </select>
        </div>
        <div><label for="priceUnit">Unit price</label><input id="priceUnit" type="number" min="0" step="0.01" inputmode="decimal" placeholder="3.50"></div>
        <div><label for="taxPct">Sales tax (percent)</label><input id="taxPct" type="number" min="0" step="0.1" inputmode="decimal" placeholder="7.5"></div>
        <div><label for="fees">Extra fees (US dollars)</label><input id="fees" type="number" min="0" step="0.01" inputmode="decimal" placeholder="12.00"></div>
      </div>
      <div class="muted">Cost = rounded slices or pies (based on pricing mode) x unit price + tax + extra fees.</div>
    </div>

    <!-- Footer disclaimer -->
    <div class="muted" style="text-align:center;margin:16px 0 0 0;">
      This tool provides general portion and cost estimates for planning only. Results depend on the information you enter and typical averages.
      DinnerMath is not responsible for decisions, purchases, or outcomes based on these estimates.<br>
      © 2025 DinnerMath. All rights reserved. Use for planning only.
    </div>

  </div>

<script>
(function(){
  // Utilities
  const $ = (id)=>document.getElementById(id);
  const N = (v,f=0)=>{ const n=Number(v); return isFinite(n)?n:f; };
  const money = n => (isFinite(n)&&n>=0) ? "$"+n.toFixed(2) : "$-";
  const roundQuarter = n => Math.round(n*4)/4;

  function courseMult(course){
    if(course==="party") return 1.20;
    if(course==="wedding") return 0.65;
    if(course==="coffee") return 0.75;
    return 1.00; // dessert table
  }
  function lenMult(val){ return N(val,1.0); }

  function compute(){
    const A=N($("A").value,0), T=N($("T").value,0), C=N($("C").value,0);
    const guests = A+T+C;

    const appetite = N($("appetite").value,1.00);
    const leftovers = N($("leftovers").value,1.00);
    const length = N($("length").value,1.00);
    const course = $("course").value;

    // base slices per person
    const base = { adult:1.0, teen:1.25, child:0.5 };
    let slices = (A*base.adult + T*base.teen + C*base.child);

    // global scalers
    slices *= courseMult(course) * appetite * lenMult(length) * leftovers;

    // pies from slices: select value "slicesPerPie|diameterIn"
    const pieVal = ($("pie").value||"8|9").split("|");
    const slicesPerPie = N(pieVal[0],8);

    const slicesRounded = Math.ceil(Math.max(0,slices));
    const pies = slicesRounded>0 ? Math.ceil(slicesRounded / slicesPerPie) : 0;

    // pie pounds: assume ~5.0 oz per dessert slice baseline
    const ozPerSlice = 5.0;
    const pounds = (slicesRounded * ozPerSlice) / 16.0;
    const poundsRounded = roundQuarter(Math.max(0,pounds));

    // Pricing
    const mode=($("priceMode")||{}).value||"slice";
    const price=N($("priceUnit").value,0), tax=N($("taxPct").value,0)/100, fees=N($("fees").value,0);
    let baseQty = 0;
    if(mode==="slice"){ baseQty = slicesRounded; }
    else if(mode==="pie"){ baseQty = pies; }
    const subtotal = (price>0 && baseQty>0) ? baseQty*price : 0;
    const adds = subtotal*tax + (fees>0?fees:0);
    const total = subtotal + adds;
    const ppp = (guests>0 && total>0) ? total/guests : NaN;

    return {guests, slicesRounded, pies, poundsRounded, subtotal, adds, total, ppp,
      appetite, length, leftovers, course, slicesPerPie};
  }


  // Intelligent warnings for pie size classes (slice-based)
  function updateBatchNotePie(s){
    const noteEl = document.getElementById("outBatchNote");
    if (!noteEl) return;
    noteEl.textContent = "";

    // Parse selected pie size: text like "Jumbo - 12 in pie (about 12 slices)"
    const pieSel = (document.getElementById("pie")||{}).selectedOptions?.[0];
    const pieText = pieSel ? pieSel.text : "";
    const m = /about\s*([\d.]+)\s*slices/i.exec(pieText);
    const slicesPerPie = m ? parseFloat(m[1]) : NaN;

    const needSlices = s.slicesRounded || 0;
    const pies = s.pies || 0;
    const totalSlices = (isFinite(slicesPerPie) && pies>0) ? slicesPerPie * pies : 0;

    // Minimum batch: one pie materially above need
    if (pies === 1 && isFinite(slicesPerPie) && (slicesPerPie >= needSlices*1.2 || (slicesPerPie - needSlices) >= 2)) {
      const name = pieText.split(" - ")[0]?.toLowerCase() || "pie";
      noteEl.textContent =
        "Minimum batch size: one " + name + " (about " +
        (Math.round(slicesPerPie*100)/100) +
        " slices) is larger than you need — leftovers expected.";
      return;
    }

    // Heads up for 2+ pies materially above need
    if (pies >= 2 && isFinite(totalSlices) && (totalSlices >= needSlices*1.3 || (totalSlices - needSlices) >= 5)) {
      noteEl.textContent =
        "Heads up: " + pies + " pies (about " + 
        (Math.round(totalSlices*100)/100) +
        " slices) is above what you need (" + needSlices +
        " slices). Consider a smaller class or mixing sizes.";
    }
  }

  function render(){
    // Select-all on focus for A/T/C
    ["A","T","C"].forEach(id=>{
      const el=$(id);
      if(el && !el._dmSel){ el._dmSel=true; el.addEventListener("focus",()=>{ try{ el.select(); }catch(e){} }); }
    });

    const s = compute();

    const appetiteTxt = $("appetite").selectedOptions[0].text.toLowerCase();
    const lengthTxt = $("length").selectedOptions[0].text.toLowerCase();
    const leftTxt = $("leftovers").selectedOptions[0].text.toLowerCase();
    const courseTxt = ({"dessert":"dessert table","party":"party main dessert","wedding":"wedding slivers","coffee":"coffee break"})[$("course").value] || "dessert table";
    const pieTxt = $("pie").selectedOptions[0].text.toLowerCase();

    // Big number + ARIA (slices primary)
    const slicesTxt = s.guests>0 ? String(s.slicesRounded) + " slices" : "-";
    $("outSlices").textContent = slicesTxt;
    $("outSlices").setAttribute("aria-label", s.guests>0 ? ("Estimated slices to serve: " + s.slicesRounded) : "No estimate yet");

    // Inline "also" sentence like your doughnuts example
    $("outAlso").textContent = s.guests>0
      ? ("About " + s.pies + " pies total and " +
         ((s.poundsRounded%1)? s.poundsRounded.toFixed(2) : s.poundsRounded.toFixed(0)) +
         " lb for pricing.")
      : "";

    // "Estimated from" summary + micro-summary
    $("outFrom").textContent = s.guests>0
      ? ("Estimated from " + s.guests + " guests - " + courseTxt + " - " + appetiteTxt + " appetite - " + lengthTxt + ", leftovers " + leftTxt + ", " + pieTxt + ".")
      : "-";

    $("outMicro").textContent = s.guests>0
      ? (s.guests + " guests • " + courseTxt + " • " + appetiteTxt + " appetite • " + lengthTxt + " • leftovers " + leftTxt + " • " + pieTxt)
      : "-";

    // Pricing
    $("outSubtotal").textContent = (s.subtotal>0) ? money(s.subtotal) : "$-";
    $("outAdds").textContent = (s.adds>0) ? money(s.adds) : "$-";
    $("outTotal").textContent = (s.total>0) ? money(s.total) : "$-";
    $("outPPP").textContent = (s.ppp>0) ? money(s.ppp) : "$-";

    // Clear note (no batch min logic for slices)
    updateBatchNotePie(s);
  }

  // Wire up inputs
  document.addEventListener("input", render, {passive:true});
  document.addEventListener("change", render, {passive:true});

  // Presets + Reset
  document.querySelectorAll(".preset[data-people]").forEach(btn=>{
    btn.addEventListener("click", e=>{
      const n = Number(btn.getAttribute("data-people"))||0;
      if(n>=0){ $("A").value = String(n); $("T").value="0"; $("C").value="0"; render(); }
    });
  });
  const reset = document.getElementById("dmReset");
  if(reset){
    reset.addEventListener("click", ()=>{
      try{
        $("A").value="10"; $("T").value="0"; $("C").value="0";
        $("course").value="dessert"; $("length").value="1.00"; $("leftovers").value="1.00"; $("appetite").value="1.00"; $("pie").value="8|9";
        $("priceMode").value="slice"; $("priceUnit").value=""; $("taxPct").value=""; $("fees").value="";
        document.querySelectorAll("input, select").forEach(el=>{
          el.dispatchEvent(new Event("input",{bubbles:true}));
          el.dispatchEvent(new Event("change",{bubbles:true}));
        });
        const a=$("A"); try{ a.focus({preventScroll:true}); a.select(); }catch(e){}
      }catch(e){}
      render();
    });
  }

  // Initial render
  render();
})();
</script>
</body>
</html>
